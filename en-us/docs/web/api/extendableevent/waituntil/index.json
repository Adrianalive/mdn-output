{"doc":{"isMarkdown":true,"isTranslated":false,"isActive":true,"flaws":{},"title":"ExtendableEvent.waitUntil()","mdn_url":"/en-US/docs/Web/API/ExtendableEvent/waitUntil","locale":"en-US","native":"English (US)","sidebarHTML":"<ol><li><strong><a href=\"/en-US/docs/Web/API/Service_Worker_API\">Service Worker API</a></strong></li><li><strong><a href=\"/en-US/docs/Web/API/ExtendableEvent\"><code>ExtendableEvent</code></a></strong></li><li class=\"toggle\"><details open=\"\"><summary>Constructor</summary><ol><li><svg class=\"icon icon-experimental\" tabindex=\"0\">\n    <use xlink:href=\"/assets/badges.svg#icon-experimental\"></use>\n</svg><a href=\"/en-US/docs/Web/API/ExtendableEvent/ExtendableEvent\"><code>ExtendableEvent()</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Methods</summary><ol><li><em><code>waitUntil()</code></em></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Inheritance:</summary><ol><li><a href=\"/en-US/docs/Web/API/Event\"><code>Event</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Related pages for Service Workers API</summary><ol><li><a href=\"/en-US/docs/Web/API/Cache\"><code>Cache</code></a></li><li><a href=\"/en-US/docs/Web/API/CacheStorage\"><code>CacheStorage</code></a></li><li><a href=\"/en-US/docs/Web/API/Client\"><code>Client</code></a></li><li><a href=\"/en-US/docs/Web/API/Clients\"><code>Clients</code></a></li><li><a href=\"/en-US/docs/Web/API/FetchEvent\"><code>FetchEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/InstallEvent\"><code>InstallEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/Navigator/serviceWorker\"><code>Navigator.serviceWorker</code></a></li><li><a href=\"/en-US/docs/Web/API/NotificationEvent\"><code>NotificationEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/PeriodicSyncEvent\"><code>PeriodicSyncEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/PeriodicSyncManager\"><code>PeriodicSyncManager</code></a></li><li><a class=\"page-not-created\" title=\"The documentation about this has not yet been written; please consider contributing!\"><code>PeriodicSyncRegistration</code></a></li><li><a href=\"/en-US/docs/Web/API/ServiceWorker\"><code>ServiceWorker</code></a></li><li><a href=\"/en-US/docs/Web/API/ServiceWorkerContainer\"><code>ServiceWorkerContainer</code></a></li><li><a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope\"><code>ServiceWorkerGlobalScope</code></a></li><li><a href=\"/en-US/docs/Web/API/ServiceWorkerRegistration\"><code>ServiceWorkerRegistration</code></a></li><li><a href=\"/en-US/docs/Web/API/SyncEvent\"><code>SyncEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/SyncManager\"><code>SyncManager</code></a></li><li><a class=\"page-not-created\" title=\"The documentation about this has not yet been written; please consider contributing!\"><code>SyncRegistration</code></a></li><li><a href=\"/en-US/docs/Web/API/WindowClient\"><code>WindowClient</code></a></li></ol></details></li></ol>","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>\n  The <strong><code>ExtendableEvent.waitUntil()</code></strong>\n  method tells the event dispatcher that work is ongoing. It can also be used to detect\n  whether that work was successful. In service workers, <code>waitUntil()</code> tells\n  the browser that work is ongoing until the promise settles, and it shouldn't terminate\n  the service worker if it wants that work to complete.\n</p>\n<p>\n  The <a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/install_event\" title=\"install\"><code>install</code></a> events in <a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope\">service workers</a> use\n  <code>waitUntil()</code> to hold the service worker in\n  the <a href=\"/en-US/docs/Web/API/ServiceWorkerRegistration/installing\" title=\"installing\"><code>installing</code></a> phase until tasks\n  complete. If the promise passed to <code>waitUntil()</code> rejects, the install is\n  considered a failure, and the installing service worker is discarded. This is primarily\n  used to ensure that a service worker is not considered installed until all of the core\n  caches it depends on are successfully populated.\n</p>\n<p>\n  The <a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope/activate_event\" title=\"activate\"><code>activate</code></a> events in <a href=\"/en-US/docs/Web/API/ServiceWorkerGlobalScope\">service workers</a> use\n  <code>waitUntil()</code> to buffer functional events such as <code>fetch</code> and\n  <code>push</code> until the promise passed to <code>waitUntil()</code> settles. This\n  gives the service worker time to update database schemas and delete outdated\n  <a href=\"/en-US/docs/Web/API/Cache\" title=\"caches\"><code>caches</code></a>, so other events can rely on a completely upgraded state.\n</p>\n<p>\n  The <code>waitUntil()</code> method must be initially called within the event callback,\n  but after that it can be called multiple times, until all the promises passed to it\n  settle.\n</p>\n<div class=\"notecard note\" id=\"sect1\">\n  <p>\n    <strong>Note:</strong> The behavior described in the above paragraph was fixed in\n    Firefox 43 (see <a href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=1180274\" class=\"external\" rel=\" noopener\">bug&nbsp;1180274</a>).\n  </p>\n</div>"}},{"type":"prose","value":{"id":"syntax","title":"Syntax","isH3":false,"content":"<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>extendableEvent<span class=\"token punctuation\">.</span><span class=\"token function\">waitUntil</span><span class=\"token punctuation\">(</span>promise<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"parameters","title":"Parameters","isH3":true,"content":"<p>A <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\"><code>Promise</code></a>.</p>"}},{"type":"prose","value":{"id":"example","title":"Example","isH3":false,"content":"<p>Using <code>waitUntil()</code> within a service worker's <code>install</code> event:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'install'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">event</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">preCache</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> cache <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> caches<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'static-v1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> cache<span class=\"token punctuation\">.</span><span class=\"token function\">addAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n      <span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">'/about/'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">'/static/styles.css'</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  event<span class=\"token punctuation\">.</span><span class=\"token function\">waitUntil</span><span class=\"token punctuation\">(</span><span class=\"token function\">preCache</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"specifications","value":{"title":"Specifications","id":"specifications","isH3":false,"specifications":[{"bcdSpecificationURL":"https://w3c.github.io/ServiceWorker/#dom-extendableevent-waituntil","title":"Service Workers 1"}],"query":"api.ExtendableEvent.waitUntil"}},{"type":"browser_compatibility","value":{"title":"Browser compatibility","id":"browser_compatibility","isH3":false,"query":"api.ExtendableEvent.waitUntil","dataURL":"/en-US/docs/Web/API/ExtendableEvent/waitUntil/bcd.json"}},{"type":"prose","value":{"id":"see_also","title":"See also","isH3":false,"content":"<ul>\n  <li><a href=\"/en-US/docs/Web/API/Service_Worker_API/Using_Service_Workers\">Using Service\nWorkers</a></li>\n  <li><a href=\"https://jakearchibald.github.io/isserviceworkerready/\" class=\"external\" rel=\" noopener\">Is ServiceWorker\nready?</a></li>\n  <li><a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\"><code>Promise</code></a></li>\n</ul>"}}],"toc":[{"text":"Syntax","id":"syntax"},{"text":"Example","id":"example"},{"text":"Specifications","id":"specifications"},{"text":"Browser compatibility","id":"browser_compatibility"},{"text":"See also","id":"see_also"}],"summary":"The ExtendableEvent.waitUntil()\n  method tells the event dispatcher that work is ongoing. It can also be used to detect\n  whether that work was successful. In service workers, waitUntil() tells\n  the browser that work is ongoing until the promise settles, and it shouldn't terminate\n  the service worker if it wants that work to complete.","popularity":0.0017,"modified":"2022-02-18T09:24:31.000Z","other_translations":[{"title":"ExtendableEvent.waitUntil()","locale":"ja","native":"日本語"},{"title":"ExtendableEvent.waitUntil()","locale":"ru","native":"Русский"},{"title":"ExtendableEvent.waitUntil()","locale":"zh-CN","native":"中文 (简体)"}],"source":{"folder":"en-us/web/api/extendableevent/waituntil","github_url":"https://github.com/mdn/content/blob/style/old/files/en-us/web/api/extendableevent/waituntil/index.md","last_commit_url":"https://github.com/mdn/content/commit/89c8199b06e7fb2b76da4087cb9eedef065b2506","filename":"index.md"},"parents":[{"uri":"/en-US/docs/Web","title":"Web technology for developers"},{"uri":"/en-US/docs/Web/API","title":"Web APIs"},{"uri":"/en-US/docs/Web/API/ExtendableEvent","title":"ExtendableEvent"},{"uri":"/en-US/docs/Web/API/ExtendableEvent/waitUntil","title":"ExtendableEvent.waitUntil()"}],"pageTitle":"ExtendableEvent.waitUntil() - Web APIs | MDN","noIndexing":false}}