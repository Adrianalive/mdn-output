{"doc":{"isMarkdown":true,"isTranslated":false,"isActive":true,"flaws":{},"title":"AddressErrors","mdn_url":"/en-US/docs/Web/API/AddressErrors","locale":"en-US","native":"English (US)","sidebarHTML":"<ol><li><strong><a href=\"/en-US/docs/Web/API/Payment_Request_API\">Payment Request API</a></strong></li><li><strong><a href=\"/en-US/docs/Web/API/AddressErrors\"><code>AddressErrors</code></a></strong></li><li class=\"toggle\"><details open=\"\"><summary>Properties</summary><ol><li><a href=\"/en-US/docs/Web/API/AddressErrors/addressLine\"><code>addressLine</code></a></li><li><a href=\"/en-US/docs/Web/API/AddressErrors/city\"><code>city</code></a></li><li><a href=\"/en-US/docs/Web/API/AddressErrors/country\"><code>country</code></a></li><li><a href=\"/en-US/docs/Web/API/AddressErrors/dependentLocality\"><code>dependentLocality</code></a></li><li><svg class=\"icon icon-deprecated\" tabindex=\"0\">\n    <use xlink:href=\"/assets/badges.svg#icon-deprecated\"></use>\n</svg><a href=\"/en-US/docs/Web/API/AddressErrors/languageCode\"><code>languageCode</code></a></li><li><a href=\"/en-US/docs/Web/API/AddressErrors/organization\"><code>organization</code></a></li><li><a href=\"/en-US/docs/Web/API/AddressErrors/phone\"><code>phone</code></a></li><li><a href=\"/en-US/docs/Web/API/AddressErrors/postalCode\"><code>postalCode</code></a></li><li><a href=\"/en-US/docs/Web/API/AddressErrors/recipient\"><code>recipient</code></a></li><li><a href=\"/en-US/docs/Web/API/AddressErrors/region\"><code>region</code></a></li><li><a href=\"/en-US/docs/Web/API/AddressErrors/sortingCode\"><code>sortingCode</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Related pages for Payment Request API</summary><ol><li><a href=\"/en-US/docs/Web/API/HTMLIFrameElement/allowPaymentRequest\"><code>HTMLIFrameElement.allowPaymentRequest</code></a></li><li><a href=\"/en-US/docs/Web/API/MerchantValidationEvent\"><code>MerchantValidationEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/PaymentAddress\"><code>PaymentAddress</code></a></li><li><a href=\"/en-US/docs/Web/API/PaymentMethodChangeEvent\"><code>PaymentMethodChangeEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/PaymentRequest\"><code>PaymentRequest</code></a></li><li><a href=\"/en-US/docs/Web/API/PaymentRequestUpdateEvent\"><code>PaymentRequestUpdateEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/PaymentResponse\"><code>PaymentResponse</code></a></li></ol></details></li></ol>","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>The <strong><code>AddressErrors</code></strong> dictionary is used by the <a href=\"/en-US/docs/Web/API/Payment_Request_API\">Payment Request API</a> to report validation errors in a physical address (typically a billing address or a shipping address). Any members which are present indicate that a validation error occurred for the member of the same name in an address described using <a href=\"/en-US/docs/Web/API/PaymentAddress\"><code>PaymentAddress</code></a>.</p>\n<p><code>AddressErrors</code> is the type of the object returned by <code>shippingAddressErrors</code> in the object passed into <a href=\"/en-US/docs/Web/API/PaymentRequestUpdateEvent/updateWith\"><code>PaymentRequestUpdateEvent.updateWith()</code></a> by the <code><a href=\"/en-US/docs/Web/API/PaymentRequest/shippingaddresschange_event\" title=\"/en-US/docs/Web/Events/shippingaddresschange\">shippingaddresschange</a></code> event handler if a change to the address resulted in a validation error occurring.</p>\n<p>See the <a href=\"#examples\">examples below</a> to see how this works.</p>"}},{"type":"prose","value":{"id":"properties","title":"Properties","isH3":false,"content":"<dl>\n  <dt id=\"addressline\"><a href=\"/en-US/docs/Web/API/AddressErrors/addressLine\" title=\"addressLine\"><code>addressLine</code></a></dt>\n  <dd>\n    <p>A <a href=\"/en-US/docs/Web/API/DOMString\"><code>DOMString</code></a> which, if present, indicates that the <a href=\"/en-US/docs/Web/API/PaymentAddress/addressLine\" title=\"addressLine\"><code>addressLine</code></a> property of the <a href=\"/en-US/docs/Web/API/PaymentAddress\"><code>PaymentAddress</code></a> could not be validated. The contents of the string provide a human-readable explanation of the validation failure, and ideally suggestions to correct the problem.</p>\n  </dd>\n  <dt id=\"city\"><a href=\"/en-US/docs/Web/API/AddressErrors/city\" title=\"city\"><code>city</code></a></dt>\n  <dd>\n    <p>A <a href=\"/en-US/docs/Web/API/DOMString\"><code>DOMString</code></a> which, if present, indicates that the <a href=\"/en-US/docs/Web/API/PaymentAddress/city\" title=\"city\"><code>city</code></a> property of the <a href=\"/en-US/docs/Web/API/PaymentAddress\"><code>PaymentAddress</code></a> could not be validated. The contents of the string provide a human-readable explanation of the validation failure, and ideally suggestions to correct the problem.</p>\n  </dd>\n  <dt id=\"country\"><a href=\"/en-US/docs/Web/API/AddressErrors/country\" title=\"country\"><code>country</code></a></dt>\n  <dd>\n    <p>A <a href=\"/en-US/docs/Web/API/DOMString\"><code>DOMString</code></a> which, if present, indicates that the <a href=\"/en-US/docs/Web/API/PaymentAddress/country\" title=\"country\"><code>country</code></a> property of the <a href=\"/en-US/docs/Web/API/PaymentAddress\"><code>PaymentAddress</code></a> could not be validated. The contents of the string provide a human-readable explanation of the validation failure, and ideally suggestions to correct the problem.</p>\n  </dd>\n  <dt id=\"dependentlocality\"><a href=\"/en-US/docs/Web/API/AddressErrors/dependentLocality\" title=\"dependentLocality\"><code>dependentLocality</code></a></dt>\n  <dd>\n    <p>A <a href=\"/en-US/docs/Web/API/DOMString\"><code>DOMString</code></a> which, if present, indicates that the <a href=\"/en-US/docs/Web/API/PaymentAddress/dependentLocality\" title=\"dependentLocality\"><code>dependentLocality</code></a> property of the <a href=\"/en-US/docs/Web/API/PaymentAddress\"><code>PaymentAddress</code></a> could not be validated. The contents of the string provide a human-readable explanation of the validation failure, and ideally suggestions to correct the problem.</p>\n  </dd>\n  <dt id=\"organization\"><a href=\"/en-US/docs/Web/API/AddressErrors/organization\" title=\"organization\"><code>organization</code></a></dt>\n  <dd>\n    <p>A <a href=\"/en-US/docs/Web/API/DOMString\"><code>DOMString</code></a> which, if present, indicates that the <a href=\"/en-US/docs/Web/API/PaymentAddress/organization\" title=\"organization\"><code>organization</code></a> property of the <a href=\"/en-US/docs/Web/API/PaymentAddress\"><code>PaymentAddress</code></a> could not be validated. The contents of the string provide a human-readable explanation of the validation failure, and ideally suggestions to correct the problem.</p>\n  </dd>\n  <dt id=\"phone\"><a href=\"/en-US/docs/Web/API/AddressErrors/phone\" title=\"phone\"><code>phone</code></a></dt>\n  <dd>\n    <p>A <a href=\"/en-US/docs/Web/API/DOMString\"><code>DOMString</code></a> which, if present, indicates that the <a href=\"/en-US/docs/Web/API/PaymentAddress/phone\" title=\"phone\"><code>phone</code></a> property of the <a href=\"/en-US/docs/Web/API/PaymentAddress\"><code>PaymentAddress</code></a> could not be validated. The contents of the string provide a human-readable explanation of the validation failure, and ideally suggestions to correct the problem.</p>\n  </dd>\n  <dt id=\"postalcode\"><a href=\"/en-US/docs/Web/API/AddressErrors/postalCode\" title=\"postalCode\"><code>postalCode</code></a></dt>\n  <dd>\n    <p>A <a href=\"/en-US/docs/Web/API/DOMString\"><code>DOMString</code></a> which, if present, indicates that the <a href=\"/en-US/docs/Web/API/PaymentAddress/postalCode\" title=\"postalCode\"><code>postalCode</code></a> property of the <a href=\"/en-US/docs/Web/API/PaymentAddress\"><code>PaymentAddress</code></a> could not be validated. The contents of the string provide a human-readable explanation of the validation failure, and ideally suggestions to correct the problem.</p>\n  </dd>\n  <dt id=\"recipient\"><a href=\"/en-US/docs/Web/API/AddressErrors/recipient\" title=\"recipient\"><code>recipient</code></a></dt>\n  <dd>\n    <p>A <a href=\"/en-US/docs/Web/API/DOMString\"><code>DOMString</code></a> which, if present, indicates that the <a href=\"/en-US/docs/Web/API/PaymentAddress/recipient\" title=\"recipient\"><code>recipient</code></a> property of the <a href=\"/en-US/docs/Web/API/PaymentAddress\"><code>PaymentAddress</code></a> could not be validated. The contents of the string provide a human-readable explanation of the validation failure, and ideally suggestions to correct the problem.</p>\n  </dd>\n  <dt id=\"region\"><a href=\"/en-US/docs/Web/API/AddressErrors/region\" title=\"region\"><code>region</code></a></dt>\n  <dd>\n    <p>A <a href=\"/en-US/docs/Web/API/DOMString\"><code>DOMString</code></a> which, if present, indicates that the <a href=\"/en-US/docs/Web/API/PaymentAddress/region\" title=\"region\"><code>region</code></a> property of the <a href=\"/en-US/docs/Web/API/PaymentAddress\"><code>PaymentAddress</code></a> could not be validated. The contents of the string provide a human-readable explanation of the validation failure, and ideally suggestions to correct the problem.</p>\n  </dd>\n  <dt id=\"sortingcode\"><a href=\"/en-US/docs/Web/API/AddressErrors/sortingCode\" title=\"sortingCode\"><code>sortingCode</code></a></dt>\n  <dd>\n    <p>A <a href=\"/en-US/docs/Web/API/DOMString\"><code>DOMString</code></a> which, if present, indicates that the <a href=\"/en-US/docs/Web/API/PaymentAddress/sortingCode\" title=\"sortingCode\"><code>sortingCode</code></a> property of the <a href=\"/en-US/docs/Web/API/PaymentAddress\"><code>PaymentAddress</code></a> could not be validated. The contents of the string provide a human-readable explanation of the validation failure, and ideally suggestions to correct the problem.</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"obsolete_properties","title":"Obsolete properties","isH3":true,"content":"<p>These properties have been removed from the specification and should no longer be used.</p>\n<dl>\n  <dt id=\"languagecode\"><a href=\"/en-US/docs/Web/API/AddressErrors/languageCode\" title=\"languageCode\"><code>languageCode</code></a> <svg class=\"icon icon-deprecated\" tabindex=\"0\">\n    <use xlink:href=\"/assets/badges.svg#icon-deprecated\"></use>\n</svg></dt>\n  <dd>\n    <p>A <a href=\"/en-US/docs/Web/API/DOMString\"><code>DOMString</code></a> which, if present, indicates that the <a href=\"/en-US/docs/Web/API/PaymentAddress/languageCode\" title=\"languageCode\"><code>languageCode</code></a> property of the <a href=\"/en-US/docs/Web/API/PaymentAddress\"><code>PaymentAddress</code></a> could not be validated. The contents of the string provide a human-readable explanation of the validation failure, and ideally suggestions to correct the problem.</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"usage_notes","title":"Usage notes","isH3":false,"content":"<p>Keep in mind that some violation errors may be outside the ability of the user to fix. Try to avoid asking the user to make corrections to things they can't change, and there may be situations in which you need to allow validation errors to be accepted anyway (for example, if you validate addresses against a postal service database and a new home has been built and its address is not yet in the database).</p>"}},{"type":"prose","value":{"id":"examples","title":"Examples","isH3":false,"content":""}},{"type":"prose","value":{"id":"snippet_limiting_destination_countries","title":"Snippet: Limiting destination countries","isH3":true,"content":"<p>This first example is just a snippet showing an implementation of the event handler for the <code><a href=\"/en-US/docs/Web/API/PaymentRequest/shippingaddresschange_event\" title=\"/en-US/docs/Web/Events/shippingaddresschange\">shippingaddresschange</a></code> event which checks to be sure the chosen address is located within one of a limited number of countries.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">handleAddressChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">ev</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> validCountries <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"US\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"CA\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"GB\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"JP\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"CN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"MX\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> genericAddressError <span class=\"token operator\">=</span> <span class=\"token string\">\"Unable to ship to the given address. Please check for any errors.\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> invalidCountryError <span class=\"token operator\">=</span> <span class=\"token string\">\"At this time, we only ship to the United States, Canada, Great Britain, Japan, China, and Germany.\"</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">let</span> shippingAddress <span class=\"token operator\">=</span> ev<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>shippingAddress<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> shippingAddressErrors <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> updateDetails <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>validCountries<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>shippingAddress<span class=\"token punctuation\">.</span>country<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    ev<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>shippingOptions <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    shippingAddressErrors<span class=\"token punctuation\">.</span>country <span class=\"token operator\">=</span> invalidCountryError<span class=\"token punctuation\">;</span>\n\n    updateDetails <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">error</span><span class=\"token operator\">:</span> genericAddressError<span class=\"token punctuation\">,</span>\n      shippingAddressErrors<span class=\"token punctuation\">,</span>\n      <span class=\"token operator\">...</span>defaultPaymentDetails\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  ev<span class=\"token punctuation\">.</span><span class=\"token function\">updateWith</span><span class=\"token punctuation\">(</span>updateDetails<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>See <a href=\"#handling_address_changes\">Handling address changes</a> for a description of how this code works.</p>"}},{"type":"prose","value":{"id":"complete_example","title":"Complete example","isH3":true,"content":"<p>Here we'll see a complete, working version of the example above (except of course that it's not connected to an actual payment handler, so no payments are actually processed). In the example, we're handling a donation to an organization that will be sending a \"thank you\" gift to the donor, so it requests shipping information along with allowing the donation payment itself.</p>\n<h4 id=\"javascript\">JavaScript</h4>\n<h5 id=\"payment_request_data\">Payment Request data</h5>\n<p>First, we declare the variables <code>supportedHandlers</code>, which is compatible with <a class=\"page-not-created\" title=\"The documentation about this has not yet been written; please consider contributing!\"><code>PaymentMethodData</code></a>, and <code>defaultPaymentDetails</code>, which is an object containing the properties described in <a href=\"/en-US/docs/Web/API/PaymentRequestUpdateEvent/updateWith\"><code>PaymentRequestUpdateEvent.updateWith</code></a>.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">let</span> supportedHandlers <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">supportedMethods</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://example.com/pay\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">let</span> defaultPaymentDetails <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">total</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">label</span><span class=\"token operator\">:</span> <span class=\"token string\">'Donation'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">amount</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">currency</span><span class=\"token operator\">:</span> <span class=\"token string\">'USD'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token string\">'65.00'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">displayItems</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">label</span><span class=\"token operator\">:</span> <span class=\"token string\">'Original donation amount'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">amount</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">currency</span><span class=\"token operator\">:</span> <span class=\"token string\">'USD'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token string\">'65.00'</span><span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">shippingOptions</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">id</span><span class=\"token operator\">:</span> <span class=\"token string\">'standard'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">label</span><span class=\"token operator\">:</span> <span class=\"token string\">'Standard shipping'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">amount</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">currency</span><span class=\"token operator\">:</span> <span class=\"token string\">'USD'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token string\">'0.00'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">selected</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p><code>supportedHandlers</code> describes the supported payment handlers and the details for those. In this example, only the Example Pay payment handler is supported.</p>\n<p><code>defaultPaymentDetails</code> describes the payment being requested. A description of the total amount being requested (including a label and the currency used), a list of the line items (in this case only one, \"Original donation amount\"), and a list of shipping options available; in this case only one.</p>\n<h5 id=\"process_the_payment\">Process the payment</h5>\n<p>The main payment processing code is found in the <code>process()</code> method, up next.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">let</span> request<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">process</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> options <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">requestShipping</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PaymentRequest</span><span class=\"token punctuation\">(</span>supportedHandlers<span class=\"token punctuation\">,</span> defaultPaymentDetails<span class=\"token punctuation\">,</span> options<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// Add event listeners here.</span>\n    request<span class=\"token punctuation\">.</span>onshippingaddresschange <span class=\"token operator\">=</span> handleAddressChange<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// Call show() to trigger the browser's payment flow.</span>\n    request<span class=\"token punctuation\">.</span><span class=\"token function\">show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">instrumentResponse</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Do something with the response from the UI.</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Got response!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">err</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Do something with the error from request.show().</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Error from show(): </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>err<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Catch any errors from trying to create the PaymentRequest object.</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>This code creates a new <a href=\"/en-US/docs/Web/API/PaymentRequest\"><code>PaymentRequest</code></a>, providing the supported handlers and payment options we set up above, as well as additional options (in this case, that we want to ask for shipping information).</p>\n<p>After that, we set up the handler for the <code><a href=\"/en-US/docs/Web/API/PaymentRequest/shippingaddresschange_event\" title=\"/en-US/docs/Web/Events/shippingaddresschange\">shippingaddresschange</a></code> event so we can validate address information and call the request's <a href=\"/en-US/docs/Web/API/PaymentRequest/show\" title=\"show()\"><code>show()</code></a> method to start running the payment UI.</p>\n<h5 id=\"handling_address_changes\">Handling address changes</h5>\n<p>The <code>handleAddressChange()</code> method, called when <code>shippingaddresschange</code> events occur, is where we'll look to see if the country is one of those we allow as shipping destinations.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">handleAddressChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">ev</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> validCountries <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"US\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"CA\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"GB\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"JP\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"CN\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"MX\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> genericAddressError <span class=\"token operator\">=</span> <span class=\"token string\">\"Unable to ship to the given address. Please check for any errors.\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> invalidCountryError <span class=\"token operator\">=</span> <span class=\"token string\">\"At this time, we only ship to the United States, Canada, Great Britain, Japan, China, and Germany.\"</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">let</span> shippingAddress <span class=\"token operator\">=</span> ev<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>shippingAddress<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> shippingAddressErrors <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> updateDetails <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>validCountries<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>shippingAddress<span class=\"token punctuation\">.</span>country<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    ev<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>shippingOptions <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    shippingAddressErrors<span class=\"token punctuation\">.</span>country <span class=\"token operator\">=</span> invalidCountryError<span class=\"token punctuation\">;</span>\n\n    updateDetails <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">error</span><span class=\"token operator\">:</span> genericAddressError<span class=\"token punctuation\">,</span>\n      shippingAddressErrors<span class=\"token punctuation\">,</span>\n      <span class=\"token operator\">...</span>defaultPaymentDetails\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  ev<span class=\"token punctuation\">.</span><span class=\"token function\">updateWith</span><span class=\"token punctuation\">(</span>updateDetails<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>The <code>shippingaddresschange</code> event doesn't receive the <a href=\"/en-US/docs/Web/API/PaymentRequest\"><code>PaymentRequest</code></a> object directly, so we fetch it from the <a href=\"/en-US/docs/Web/API/Event/target\" title=\"target\"><code>target</code></a> property of the event. If the request's <a href=\"/en-US/docs/Web/API/PaymentRequest/shippingAddress\" title=\"shippingAddress\"><code>shippingAddress</code></a> has a value for <a href=\"/en-US/docs/Web/API/PaymentAddress/country\" title=\"country\"><code>country</code></a> which isn't in the array <code>validCountries</code>, we generate the error.</p>\n<p>That's done by removing all shipping options currently set on the request, then set up an object named <code>shippingAddressErrors</code> which contains a <code>country</code> property which is an error message describing why the stated country isn't being permitted as a value.</p>\n<p>Then an object is created with its <code>error</code> set to a generic message about address errors and with the reset of the object's values taken from <code>shippingAddressErrors</code>, and, using \"<code>...defaultPaymentDetails</code>\" as the final entry in the object, the remainder of the properties' values are taken from <code>defaultPaymentDetails</code>.</p>\n<p>The final step is to call the event's <a href=\"/en-US/docs/Web/API/PaymentRequestUpdateEvent/updateWith\" title=\"updateWith()\"><code>updateWith()</code></a> method, passing along the <code>updateDetails</code> object. This lets the Payment Request API know to present the specified error or errors but to allow the user to keep trying to edit the address.</p>\n<h5 id=\"setting_up_the_donate_now_button\">Setting up the Donate Now button</h5>\n<p>This code creates a handler for the <code><a href=\"/en-US/docs/Web/API/Window/load_event\" title=\"/en-US/docs/Web/Events/load\">load</a></code> event on the <a href=\"/en-US/docs/Web/API/Window\" title=\"window\"><code>window</code></a> which in turn adds the needed <code><a href=\"/en-US/docs/Web/API/Element/click_event\" title=\"/en-US/docs/Web/Events/click\">click</a></code> event handler to the \"Donate Now\" button so that clicking it starts the payment process.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"load\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">ev</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pay\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> process<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>See <a href=\"/en-US/docs/Web/API/EventTarget/addEventListener\" title=\"addEventListener()\"><code>addEventListener()</code></a> for information about event handlers and how they work.</p>\n<h4 id=\"html\">HTML</h4>\n<p>Here's the simple HTML for this example.</p>\n<div class=\"code-example\"><pre class=\"brush: html notranslate\"><code><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span>Donate US $65 to our worthwhile cause and we will send you a totally\nnot-useless gift as a token of our thanks!<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pay<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Donate Now<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>\n<h4 id=\"result\">Result</h4>\n<p>The final product is below.</p>\n<div class=\"notecard note\" id=\"sect1\">\n  <p><strong>Note:</strong> if you have content blocking features enabled in your browser, the example may not work inline below. In that case, you can <a href=\"http://localhost:5042/en-US/docs/Web/API/AddressErrors/_sample_.Complete_example.html\" class=\"external\" rel=\" noopener\">view the example on its own page</a>.</p>\n</div><iframe class=\"sample-code-frame\" title=\"Complete example sample\" id=\"frame_complete_example\" width=\"640\" height=\"400\" src=\"http://localhost:5042/en-US/docs/Web/API/AddressErrors/_sample_.complete_example.html\" loading=\"lazy\"></iframe>"}},{"type":"specifications","value":{"title":"Specifications","id":"specifications","isH3":false,"query":"api.AddressErrors","specifications":[]}},{"type":"browser_compatibility","value":{"title":"Browser compatibility","id":"browser_compatibility","isH3":false,"data":null,"query":"api.AddressErrors","browsers":null}}],"toc":[{"text":"Properties","id":"properties"},{"text":"Usage notes","id":"usage_notes"},{"text":"Examples","id":"examples"},{"text":"Specifications","id":"specifications"},{"text":"Browser compatibility","id":"browser_compatibility"}],"summary":"The AddressErrors dictionary is used by the Payment Request API to report validation errors in a physical address (typically a billing address or a shipping address). Any members which are present indicate that a validation error occurred for the member of the same name in an address described using PaymentAddress.","popularity":0,"modified":"2022-03-14T00:26:56.000Z","source":{"folder":"en-us/web/api/addresserrors","github_url":"https://github.com/mdn/content/blob/style/old/files/en-us/web/api/addresserrors/index.md","last_commit_url":"https://github.com/mdn/content/commit/672bace59f60c4931e5cdde8eb32919c924bd191","filename":"index.md"},"parents":[{"uri":"/en-US/docs/Web","title":"Web technology for developers"},{"uri":"/en-US/docs/Web/API","title":"Web APIs"},{"uri":"/en-US/docs/Web/API/AddressErrors","title":"AddressErrors"}],"pageTitle":"AddressErrors - Web APIs | MDN","noIndexing":false}}